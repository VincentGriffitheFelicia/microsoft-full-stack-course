@baseUrl = http://localhost:5235
@validToken = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c

### =============================================================
### MIDDLEWARE TESTING - PUBLIC ENDPOINTS (NO AUTH REQUIRED)
### =============================================================

### 1. Test Public Root Endpoint (No Auth Required)
GET {{baseUrl}}/

### =============================================================
### AUTHENTICATION TESTS
### =============================================================

### 2. Test Missing Authorization Header (Should Fail - 401)
GET {{baseUrl}}/api/users

### 3. Test Invalid Authorization Scheme (Should Fail - 401)
GET {{baseUrl}}/api/users
Authorization: InvalidScheme sometoken

### 4. Test Invalid Token (Too Short - Should Fail - 401)
GET {{baseUrl}}/api/users
Authorization: Bearer short

### 5. Test Valid Token (Should Succeed - 200)
GET {{baseUrl}}/api/users
Authorization: Bearer {{validToken}}

### =============================================================
### CRUD OPERATIONS WITH VALID TOKEN
### =============================================================

### 6. Create User with Valid Token
POST {{baseUrl}}/api/users
Content-Type: application/json
Authorization: Bearer {{validToken}}

{
  "firstName": "John",
  "lastName": "Doe",
  "email": "john.doe2@example.com",
  "phoneNumber": "+1-555-0123"
}

### 7. Get All Users with Valid Token
GET {{baseUrl}}/api/users
Authorization: Bearer {{validToken}}

### 8. Get User by ID with Valid Token
GET {{baseUrl}}/api/users/1
Authorization: Bearer {{validToken}}

### 9. Update User with Valid Token
PUT {{baseUrl}}/api/users/1
Content-Type: application/json
Authorization: Bearer {{validToken}}

{
  "firstName": "Jane",
  "lastName": "Smith",
  "email": "jane.smith@example.com",
  "phoneNumber": "+1-555-0456"
}

### 10. Create Second User with Valid Token
POST {{baseUrl}}/api/users
Content-Type: application/json
Authorization: Bearer {{validToken}}

{
  "firstName": "Bob",
  "lastName": "Johnson",
  "email": "bob.johnson@example.com",
  "phoneNumber": "+1-555-9999"
}

### 11. Delete User with Valid Token
DELETE {{baseUrl}}/api/users/2
Authorization: Bearer {{validToken}}

### =============================================================
### EXCEPTION HANDLING TESTS
### =============================================================

### 12. Test Invalid User ID (Bad Request - 400)
GET {{baseUrl}}/api/users/0
Authorization: Bearer {{validToken}}

### 13. Test Get Non-existent User (Not Found - 404)
GET {{baseUrl}}/api/users/999
Authorization: Bearer {{validToken}}

### 14. Test Invalid Email Format (Bad Request - 400)
POST {{baseUrl}}/api/users
Content-Type: application/json
Authorization: Bearer {{validToken}}

{
  "firstName": "Invalid",
  "lastName": "Email",
  "email": "not-an-email",
  "phoneNumber": "+1-555-1234"
}

### 15. Test Missing Required Field (Bad Request - 400)
POST {{baseUrl}}/api/users
Content-Type: application/json
Authorization: Bearer {{validToken}}

{
  "firstName": "Missing",
  "lastName": "Email"
}

### 16. Test Empty Request Body (Bad Request - 400)
POST {{baseUrl}}/api/users
Content-Type: application/json
Authorization: Bearer {{validToken}}

### 17. Test Duplicate Email (Bad Request - 400)
POST {{baseUrl}}/api/users
Content-Type: application/json
Authorization: Bearer {{validToken}}

{
  "firstName": "Duplicate",
  "lastName": "Email",
  "email": "john.doe@example.com",
  "phoneNumber": "+1-555-5555"
}

### =============================================================
### LOGGING VERIFICATION TESTS
### =============================================================

### 18. GET Request - Check Logs
GET {{baseUrl}}/api/users
Authorization: Bearer {{validToken}}

### 19. POST Request - Check Logs
POST {{baseUrl}}/api/users
Content-Type: application/json
Authorization: Bearer {{validToken}}

{
  "firstName": "TestUser",
  "lastName": "Logging",
  "email": "test.logging@example.com",
  "phoneNumber": "+1-555-7777"
}

### 20. Final Verification - Get All Users
GET {{baseUrl}}/api/users
Authorization: Bearer {{validToken}}

### Thread safe
GET {{baseUrl}}/thread-safe